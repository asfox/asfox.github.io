<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Read NIFTI in fmriStat.</title>
  <meta name="author" content="Drew Fox">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="Read NIFTI in fmriStat. written May 30, 2013">

  <link rel="canonical" href="/read-nifti-in-fmristat.html">



  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->

  <link href="/theme/css/bootstrap.min.css"  media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="/theme/css/screen.css"  media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="/theme/css/tomorrow.css"  media="screen, projection" rel="stylesheet" type="text/css" />


  <script>window.jQuery || document.write('<script src="/theme/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
  <script src="/theme/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
  <!-- <script src="/theme/javascripts/jquery.tweet.js" type="text/javascript"></script>
  <script src="/theme/javascripts/jquery.instagram.js" type="text/javascript"></script>
  <script src="/theme/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
  <script src="/theme/javascripts/custom.js" type="text/javascript"></script>
  -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  
</head>
  <body>
    <a href="/" class="home-icon">
      <img src="/theme/images/home.png"/>
    </a>

    <div class='my_backdrop'>

<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2 my_junk">
        <h1>Read NIFTI in fmriStat.</h1>
        <div class="meta">
          written <time datetime="2013-05-30T15:38:00-07:00">May 30, 2013</time>
        </div>
        <br>
            <p><em>If</em> you have a need to run fmristat these days, it can be frustrating that it cant read Nifti files. Using the libraries in surfStat, I added this functionality to fmriStat.
<!-- more --></p>
<p>First, you will need to install <a href="http://www.math.mcgill.ca/keith/fmristat/">fmriStat</a> and <a href="http://www.math.mcgill.ca/keith/surfstat/">surfStat</a> from Keith Worsleys website. Otherwise, updating fmristat wouldnt be that useful&hellip; ;-)</p>
<p>I overwrote a few files to call on the code from fmristat to read and write nifti files. You can download these files by clicking the link on the top-right, and simply replace the existing fmristat files. Sadly, it is that kludgy.</p>
<figure class='code'>
<figcaption><span class="liquid-tags-code-title">Read Nifti codec:utf8</span><span class="liquid-tags-code-filename">fmris_read_image.m</span><a href='/downloads/code/fmristat/fmris_read_image.m'>download</a></figcaption>

<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span>[d] <span class="p">=</span><span class="w"> </span><span class="nf">fmris_read_image</span><span class="p">(</span>file,Z,T<span class="p">)</span><span class="w"></span>

<span class="c">% (c) John Aston &amp; Roger Gunn</span>

<span class="n">file</span> <span class="p">=</span> <span class="n">deblank</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="n">if</span> <span class="s">~(file(1)==&#39;/&#39;</span> <span class="s">|</span> <span class="s">file(2)==&#39;:&#39;)</span>
   <span class="n">if</span> <span class="s">file(1:2)==&#39;./&#39;</span>
      <span class="n">file</span><span class="p">=[</span><span class="n">pwd</span> <span class="n">file</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">file</span><span class="p">))];</span>
   <span class="n">else</span>
      <span class="s">file=[pwd</span> <span class="s">&#39;/&#39;</span> <span class="s">file]</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">end</span>
   
<span class="p">[</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">ext</span><span class="p">]=</span><span class="n">fileparts</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="n">if</span> <span class="s">strcmp(ext,&#39;.gz&#39;)</span>
   <span class="n">if</span> <span class="s">isunix</span>
      <span class="n">unix</span><span class="p">([</span><span class="s">&#39;gunzip &#39;</span> <span class="n">file</span><span class="p">]);</span>
   <span class="n">else</span>
      <span class="s">[&#39;Can&#39;&#39;t gunzip on non-unix system&#39;]</span>
      <span class="n">return</span>
   <span class="s">end</span>
   <span class="p">[</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">ext</span><span class="p">]=</span><span class="n">fileparts</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="k">end</span> 

<span class="n">switch</span> <span class="s">lower(ext)</span>
<span class="k">case</span> <span class="s">&#39;.mnc&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">d</span> <span class="p">=</span> <span class="n">fmris_read_minc</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">d</span> <span class="s">=</span> <span class="s">fmris_read_minc(file)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.img&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">d</span> <span class="p">=</span> <span class="n">fmris_read_analyze</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">d</span> <span class="s">=</span> <span class="s">fmris_read_analyze(file)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.brik&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">d</span> <span class="p">=</span> <span class="n">fmris_read_afni</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">d</span> <span class="s">=</span> <span class="s">fmris_read_afni(file)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.nii&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">d</span> <span class="p">=</span> <span class="n">SurfStatReadVol1</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">d</span> <span class="s">=</span> <span class="s">SurfStatReadVol1(file)</span><span class="p">;</span>
   <span class="n">end</span>

<span class="s">otherwise</span>
   <span class="p">[</span><span class="s">&#39;Unknown file extension&#39;</span><span class="p">]</span>
<span class="k">end</span>

<span class="n">d</span><span class="p">.</span><span class="n">parent_file</span><span class="p">=</span><span class="n">file</span><span class="p">;</span>

<span class="n">return</span>
</code></pre></div>


</figure>

<figure class='code'>
<figcaption><span class="liquid-tags-code-title">Write Nifti codec:utf8</span><span class="liquid-tags-code-filename">fmris_write_image.m</span><a href='/downloads/code/fmristat/fmris_write_image.m'>download</a></figcaption>

<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span>[d]<span class="p">=</span><span class="nf">fmris_write_image</span><span class="p">(</span>d,Z,T<span class="p">)</span><span class="w"></span>

<span class="c">% (c) John Aston &amp; Roger Gunn</span>

<span class="n">file</span> <span class="p">=</span> <span class="n">deblank</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">file_name</span><span class="p">);</span>
<span class="n">if</span> <span class="s">~(file(1)==&#39;/&#39;</span> <span class="s">|</span> <span class="s">file(2)==&#39;:&#39;)</span>
   <span class="n">if</span> <span class="s">file(1:2)==&#39;./&#39;</span>
      <span class="n">file</span><span class="p">=[</span><span class="n">pwd</span> <span class="n">file</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">file</span><span class="p">))];</span>
   <span class="n">else</span>
      <span class="s">file=[pwd</span> <span class="s">&#39;/&#39;</span> <span class="s">file]</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">end</span>

<span class="p">[</span><span class="n">base</span><span class="p">,</span><span class="n">ext</span><span class="p">]=</span><span class="n">fileparts2</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="n">d</span><span class="p">.</span><span class="n">file_name</span><span class="p">=[</span><span class="n">base</span> <span class="n">ext</span><span class="p">];</span>
   
<span class="n">switch</span> <span class="s">lower(ext)</span>
<span class="k">case</span> <span class="s">&#39;.mnc&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">fmris_write_minc</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">fmris_write_minc(d)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.img&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">fmris_write_analyze</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">fmris_write_analyze(d)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.brik&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">fmris_write_afni</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">fmris_write_afni(d)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">case</span> <span class="s">&#39;.nii&#39;</span>
   <span class="n">if</span> <span class="s">nargin</span> <span class="s">==</span> <span class="s">3</span>
      <span class="n">SurfStatWriteVol1</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
   <span class="n">else</span>
      <span class="s">SurfStatWriteVol1(d)</span><span class="p">;</span>
   <span class="n">end</span>
<span class="s">otherwise</span>
   <span class="p">[</span><span class="s">&#39;Unknown file extension&#39;</span><span class="p">]</span>
<span class="k">end</span>

<span class="n">return</span>
</code></pre></div>


</figure>

<p>Feel free to contact me if you have any questions!
:-Drew</p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>

    </div>

    <footer id="footer" class="her-row">
      <div class="container">

<div class="row">
  <div class="col-sm span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">

           <li>
             <a href="fox-et-al-molecular-psychiatry-2021.html">Fox et al., Molecular Psychiatry -  2021</a>
           </li>
           <li>
             <a href="roseboom-et-al-molecular-therapy-2021.html">Roseboom et al., Molecular Therapy -  2021</a>
           </li>
           <li>
             <a href="fox-work-featured-on-cover-of-biological-psychiatry.html">Fox work featured on Cover of Biological Psychiatry</a>
           </li>
           <li>
             <a href="wang-et-al-neuroimage-2021.html">Wang et al., Neuroimage -  2021</a>
           </li>
           <li>
             <a href="klink-et-al-neuroimage-2021.html">Klink et al., Neuroimage -  2021</a>
           </li>
    </ul>
    <h2><a href="/archives">archives</a></h2>
  </div>
  <div class="col-sm span4">
<h2>twitter</h2>

<a class="twitter-timeline" data-dnt="true" data-height="300" href="https://twitter.com/foxdotdrew?ref_src=twsrc%5Etfw">Tweets by foxdotdrew</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<a href="https://twitter.com/foxdotdrew?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-dnt="true" data-show-count="false">Follow @foxdotdrew</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
  <div class="col-sm span2">
<div class="col-sm span2">
  <h2>categories</h2>
  <div class="meta" style="margin-bottom: 30px;">
 
              <a href="/category/cv.html" class="category">cv (1)</a>
 
              <a href="/category/news.html" class="category">news (4)</a>
              <a href="/category/people.html" class="category">people (6)</a>
 
              <a href="/category/posters.html" class="category">posters (48)</a>
 
              <a href="/category/publications.html" class="category">publications (84)</a>
 
              <a href="/category/thoughts.html" class="category">thoughts (6)</a>
 
              <a href="/category/tutorials.html" class="category">tutorials (7)</a>
  </div>


  <p style="text-align: center;">
  <a href="https://ds.lib.ucdavis.edu" rel="tooltip" title="DataLab UC Davis"><img title="DataLab UC Davis" alt="DataLab icon" width=100 height=100 src="https://asfox.github.io/images/datalab_centered-logo-full-color-rgb.png"></a>
  </p>


  <div class="social-icon-list">
    <a title="Twitter" href="https://twitter.com/foxdotdrew"><img src="/theme/images/glyphicons_social_31_twitter.png"/></a>
    <a title="GitHub" href="https://github.com/asfox"><img src="/theme/images/glyphicons_social_21_github.png"/></a>
    <a title="E-Mail" href="mailto:dfox@ucdavis.edu"><img src="/theme/images/glyphicons_social_39_e-mail.png"/></a>
  </div>
</div>
  </div>
</div>

        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/foxdotdrew"><img src="/theme/images/glyphicons_social_31_twitter.png"/></a>

              <a href="https://github.com/asfox"><img src="/theme/images/glyphicons_social_21_github.png"/></a>


              <a href="mailto:dfox@ucdavis.edu"><img src="/theme/images/glyphicons_social_39_e-mail.png"/></a>
            </div>
          </div>
          <div class="pull-right">
            <h4>Powered by <a href="http://blog.getpelican.com/">Pelican</a>. Originally designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a> and adapted by Drew Fox.</h4>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>