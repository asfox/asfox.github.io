<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Python Flipbook Movies</title>
  <meta name="author" content="Drew Fox">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="Python Flipbook Movies written April 01, 2013">

  <link rel="canonical" href="/python-flipbook-movies.html">



  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->

  <link href="/theme/css/bootstrap.min.css"  media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="/theme/css/screen.css"  media="screen, projection" rel="stylesheet" type="text/css" />
  <!-- link href="/theme/css/tomorrow.css"  media="screen, projection" rel="stylesheet" type="text/css" /> -->


  <!-- script>window.jQuery || document.write('<script src="/theme/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script> -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
  <script src="/theme/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
  <!-- <script src="/theme/javascripts/jquery.tweet.js" type="text/javascript"></script>
  <script src="/theme/javascripts/jquery.instagram.js" type="text/javascript"></script>
  <script src="/theme/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
  <script src="/theme/javascripts/custom.js" type="text/javascript"></script>
  -->

  
</head>
  <body>

  <nav class="navbar navbar-expand-lg navbar-light ">
    <div class="container-fluid">

    <a href="/" class="navbar-brand home-icon">
      <img src="/theme/images/home.png"/>
    </a>
<!--
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="/category/cv.html">cv<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/news.html">news<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/people.html">people<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/posters.html">posters<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/publications.html">publications<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/thoughts.html">thoughts<a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/category/tutorials.html">tutorials<a>
            </li>
    </ul>
  </div>
-->
</div>
</nav>


    <div class='my_backdrop'>

<article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2 my_junk">
        <h1>Python Flipbook Movies</h1>
        <div class="meta">
          written <time datetime="2013-04-01T13:53:00-07:00">April 01, 2013</time>
        </div>
        <br>
            <p>In my <a href="https://asfox.github.io/2013/03/20/looking-at-co-registered-brains/">Looking at Co-registered Brain Data</a> post, I showed a movie of different subjects brain data. Here is how I created that movie.
<!--more--></p>
<p>I wrote a quick bit of python code that will show slice <code>136</code> of dimension <code>2</code> (in this case sagittal) and write out a movie named <code>t1.mp4</code> at <code>5</code> frames a second, from the subjects listed in <code>t1*.nii</code>.</p>
<div class="highlight"><pre><span></span><code>drawASlice.py <span class="m">136</span> <span class="m">2</span> t1.mp4 <span class="m">5</span> t1*.nii
</code></pre></div>


<p>This code was used to create this movie.</p>
<p><span class="videobox">
            <video width="320" height="240" preload="none" controls poster="https://asfox.github.io/images/compareAlignment_movie.png"><source src='https://asfox.github.io/video/t1.mp4' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'></video></span></p>
<p>Here is the full bit of code.</p>
<figure class='code'>
<figcaption><span class="liquid-tags-code-title">Make a flipbook to check data in python codec:utf8</span><span class="liquid-tags-code-filename">drawASlice.py</span><a href='/downloads/code/drawASlice.py'>download</a></figcaption>

<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># import alot of libraries... </span>
<span class="c1"># If these aren&#39;t installed, you will have to install them. :-/</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">sliceNum</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">outf</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">in_files</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>

    <span class="c1"># Prepare to pipe to ffmpeg</span>
    <span class="n">cmdstring</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ffmpeg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;-y&#39;</span><span class="p">,</span>
        <span class="s1">&#39;-f&#39;</span><span class="p">,</span><span class="s1">&#39;image2pipe&#39;</span><span class="p">,</span>
        <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">rate</span><span class="p">,</span>
        <span class="s1">&#39;-vcodec&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span>
        <span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;320x280&#39;</span><span class="p">,</span>
        <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;pipe:&#39;</span><span class="p">,</span> <span class="n">outf</span>
        <span class="p">)</span>
    <span class="c1"># setup a ffmpeg pipe... </span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmdstring</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>

    <span class="c1"># setup a the fig and main axis to plot on</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># for each image in the input list</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">in_files</span><span class="p">):</span>
        <span class="c1"># read the image</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">img_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
        <span class="c1"># find the right slice to draw</span>
        <span class="k">if</span> <span class="n">dim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">toDraw</span> <span class="o">=</span> <span class="n">img_data</span><span class="p">[:,</span><span class="n">sliceNum</span><span class="p">,:];</span>
        <span class="k">elif</span> <span class="n">dim</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">toDraw</span> <span class="o">=</span> <span class="n">img_data</span><span class="p">[</span><span class="n">sliceNum</span><span class="p">,:,:];</span>
        <span class="k">elif</span> <span class="n">dim</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">toDraw</span> <span class="o">=</span> <span class="n">img_data</span><span class="p">[:,:,</span><span class="n">sliceNum</span><span class="p">];</span>
        <span class="c1"># orient appropriately?</span>
        <span class="n">toDraw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">toDraw</span><span class="p">)</span>
        
        <span class="c1"># show the image </span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">toDraw</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Greys_r</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># write to the pipe...</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">(),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</code></pre></div>


</figure>

<p>I also use this technique to verify that my clusters are <em>where</em> I claim they are in each participant. :-D</p>
        <hr class="divider-short"/>
        <!-- Disqus goes here -->
        <!-- <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite">Disqus goes here</div>
        </section>
        -->
      </div>
    </div>
  </div>
</article>

    </div>

    <footer id="footer" class="her-row">
      <div class="container">

<div class="row">
  <div class="col-sm span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">

           <li>
             <!-- a href="kenwood-oler-et-al-oxford-open-neuroscience-2022.html">Kenwood, Oler et al., Oxford Open Neuroscience - 2022</a>-->
             <a href="/kenwood-oler-et-al-oxford-open-neuroscience-2022.html">Kenwood, Oler et al., Oxford Open Neuroscience - 2022</a>
           </li>
           <li>
             <!-- a href="jairo-chavez.html">Jairo Chavez</a>-->
             <a href="/jairo-chavez.html">Jairo Chavez</a>
           </li>
           <li>
             <!-- a href="rani-purewal.html">Rani Purewal</a>-->
             <a href="/rani-purewal.html">Rani Purewal</a>
           </li>
           <li>
             <!-- a href="holley-fox-neurobehavioral-individual-differences-2022.html">Holley & Fox, Neurobehavioral individual differences -  2022</a>-->
             <a href="/holley-fox-neurobehavioral-individual-differences-2022.html">Holley & Fox, Neurobehavioral individual differences -  2022</a>
           </li>
           <li>
             <!-- a href="holley-fox-neuroscience-biobehavioral-reviews-2022.html">Holley & Fox, Neuroscience & Biobehavioral Reviews -  2022</a>-->
             <a href="/holley-fox-neuroscience-biobehavioral-reviews-2022.html">Holley & Fox, Neuroscience & Biobehavioral Reviews -  2022</a>
           </li>
    </ul>
    <h2><a href="/archives">archives</a></h2>
  </div>
  <div class="col-sm span4">
<h2>twitter</h2>

<a class="twitter-timeline" data-dnt="true" data-height="300" href="https://twitter.com/foxdotdrew?ref_src=twsrc%5Etfw">Tweets by foxdotdrew</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<a href="https://twitter.com/foxdotdrew?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-dnt="true" data-show-count="false">Follow @foxdotdrew</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
  <div class="col-sm span2">
<div class="col-sm span2">
  <h2>categories</h2>
  <div class="meta" style="margin-bottom: 30px;">
 
              <a href="/category/cv.html" class="category">cv (1)</a>
 
              <a href="/category/news.html" class="category">news (4)</a>
              <a href="/category/people.html" class="category">people (10)</a>
 
              <a href="/category/posters.html" class="category">posters (49)</a>
 
              <a href="/category/publications.html" class="category">publications (90)</a>
 
              <a href="/category/thoughts.html" class="category">thoughts (7)</a>
 
              <a href="/category/tutorials.html" class="category">tutorials (7)</a>
  </div>


  <p style="text-align: center;">
  <a href="https://ds.lib.ucdavis.edu" rel="tooltip" title="DataLab UC Davis"><img title="DataLab UC Davis" alt="DataLab icon" width=100 height=100 src="https://asfox.github.io/images/datalab_centered-logo-full-color-rgb.png"></a>
  </p>


  <div class="social-icon-list">
    <a title="Twitter" href="https://twitter.com/foxdotdrew"><img src="/theme/images/glyphicons_social_31_twitter.png"/></a>
    <a title="GitHub" href="https://github.com/asfox"><img src="/theme/images/glyphicons_social_21_github.png"/></a>
    <a title="E-Mail" href="mailto:dfox@ucdavis.edu"><img src="/theme/images/glyphicons_social_39_e-mail.png"/></a>
  </div>
</div>
  </div>
</div>

        <div class="row">
          <div class="col-md-1">
            <a href="/"><h4>Home</h4></a>
          </div>

          <div class="col-md-2">
            <div class="social-icon-list">
              <a href="https://twitter.com/foxdotdrew"><img src="/theme/images/glyphicons_social_31_twitter.png"/></a>

              <a href="https://github.com/asfox"><img src="/theme/images/glyphicons_social_21_github.png"/></a>


              <a href="mailto:dfox@ucdavis.edu"><img src="/theme/images/glyphicons_social_39_e-mail.png"/></a>
            </div>
          </div>
          <div class="pull-right">
            <h4>Powered by <a href="http://blog.getpelican.com/">Pelican</a>. Originally designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a> and adapted by Drew Fox.</h4>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>